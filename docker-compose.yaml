version: "3.7"

services:
  jellyfin:
    image: linuxserver/jellyfin:latest
    container_name: jellyfin
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
    group_add:
      - "109"
    devices:
      #- /dev/dri:/dev/dri
      - /dev/dri/renderD128:/dev/dri/renderD128
      - /dev/dri/card0:/dev/dri/card0
    volumes:
      - /home/stephen/docker/containers/media_server/jellyfin/config:/config
      - /home/stephen/docker/containers/media_server/media/tvshows:/data/tvshows
      - /home/stephen/docker/containers/media_server/media/movies:/data/movies
    ports:
      - 8096:8096
      - 8920:8920 #optional
      - 7359:7359/udp #optional
      - 1900:1900/udp #optional
    restart: unless-stopped

  sonarr:
    image: linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
    volumes:
      - /home/stephen/docker/containers/media_server/sonarr/config:/config
      - /home/stephen/docker/containers/media_server/media/tvshows:/tv #optional
      - /home/stephen/docker/containers/media_server/downloads/complete:/downloads #optional
    ports:
      - 8989:8989
    restart: unless-stopped

  radarr:
    image: linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
    volumes:
      - /home/stephen/docker/containers/media_server/radarr/config:/config
      - /home/stephen/docker/containers/media_server/media/movies:/movies #optional
      - /home/stephen/docker/containers/media_server/downloads/complete:/downloads #optional
    ports:
      - 7878:7878
    restart: unless-stopped

  sabnzbd:
    image: linuxserver/sabnzbd:latest
    container_name: sabnzbd
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
    volumes:
      - /home/stephen/docker/containers/media_server/sabnzbd/config:/config
      - /home/stephen/docker/containers/media_server/downloads/complete:/downloads #optional
      - /home/stephen/docker/containers/media_server/downloads/incomplete:/incomplete-downloads #optional
    ports:
      - 8080:8080
    dns:
      - "192.168.1.1"
    restart: unless-stopped

  unmanic:
    container_name: unmanic
    image: josh5/unmanic:latest
    ports:
      - 8888:8888
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
    devices:
      - /dev/dri:/dev/dri       # For H/W transcoding using the VAAPI encoder
    volumes:
      - /home/stephen/docker/containers/media_server/unmanic/config:/config
      - /home/stephen/docker/containers/media_server/media/movies:/library/movies
      - /home/stephen/docker/containers/media_server/media/tvshows:/library/tvshows
      - /home/stephen/docker/containers/media_server/unmanic/cache:/tmp/unmanic
    restart: unless-stopped

  jellyseerr:
    image: fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    environment:
         - LOG_LEVEL=debug
         - TZ=Asia/Singapore
    ports:
         - 5055:5055
    volumes:
         - /home/stephen/docker/containers/media_server/jellyseerr/config:/app/config
    restart: unless-stopped

  wireguard:
    image: linuxserver/wireguard:latest
    container_name: wireguard-server
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Singapore
      - SERVERURL=auto #optional
      - SERVERPORT=51820 #optional
      - PEERS=2 #optional
      - PEERDNS=auto #optional
      - INTERNAL_SUBNET=10.13.13.0 #optional
      - ALLOWEDIPS=0.0.0.0/0 #optional
      - LOG_CONFS=true #optional
    volumes:
      - /home/stephen/docker/containers/wireguard-server/config:/config
      - /lib/modules:/lib/modules # for kernel modules
    sysctls:
      - net.ipv4.conf.all.src_valid_mark=1
    ports:
      - 51820:51820/udp
    restart: unless-stopped
